# Crypto Wallet Manager

**ç”Ÿäº§çº§åŠ å¯†è´§å¸é’±åŒ…ç®¡ç†** - åŸºäºæœŸæœ›æ•ˆç”¨ä¸è¡Œä¸ºå®‰å…¨çš„ç†æ€§å†³ç­–æ¡†æ¶

æ”¯æŒ HD é’±åŒ… (BIP-32/39/44/49/84)ã€å¤šé“¾æ´¾ç”Ÿã€ç¡¬ä»¶é’±åŒ…é›†æˆã€å®‰å…¨å¯†é’¥ç®¡ç†ã€‚

---

## æ ¸å¿ƒç‰¹æ€§

### ğŸ” å®‰å…¨æ¶æ„ (åŸºäºæœŸæœ›æ•ˆç”¨ä¼˜åŒ–)

| å®‰å…¨å±‚çº§ | å®ç° | æ ‡å‡† | è¾¹é™…æ•ˆç”¨è¯„ä¼° |
|----------|------|------|--------------|
| å¯†é’¥æ´¾ç”Ÿ | PBKDF2 / Argon2id | BIP-39 | é«˜ï¼ˆå¼ºåˆ¶ï¼‰ |
| HDé’±åŒ… | åˆ†å±‚ç¡®å®šæ€§æ´¾ç”Ÿ | BIP-32/44/49/84 | é«˜ï¼ˆå¼ºåˆ¶ï¼‰ |
| åŠ å¯†å­˜å‚¨ | AES-256-GCM | NISTæ ‡å‡† | é«˜ï¼ˆå¼ºåˆ¶ï¼‰ |
| åŠ©è®°è¯ | 24è¯(256bit) / 12è¯(128bit) | BIP-39 | æŒ‰èµ„äº§è§„æ¨¡é€‰æ‹© |
| å¤šå› ç´  | Passphrase | BIP-39æ‰©å±• | èµ„äº§>$10kæ¨è |
| ç¡¬ä»¶éš”ç¦» | Ledger/Trezor | CC EAL5+ | èµ„äº§>$50kæ¨è |

**æœŸæœ›æ•ˆç”¨å†³ç­–çŸ©é˜µ:**

```
å®‰å…¨æŠ•èµ„ROI = (èµ„äº§ä»·å€¼ Ã— é£é™©é™ä½ç™¾åˆ†æ¯”) / å®‰å…¨æªæ–½æˆæœ¬

ç¤ºä¾‹: æŒæœ‰$20,000èµ„äº§
â”œâ”€ è½¯ä»¶é’±åŒ…(å…è´¹): å¹´æŸå¤±æ¦‚ç‡2% â†’ æœŸæœ›æŸå¤±$400
â”œâ”€ ç¡¬ä»¶é’±åŒ…($100): å¹´æŸå¤±æ¦‚ç‡0.5% â†’ æœŸæœ›æŸå¤±$100
â””â”€ ROI: ($400-$100-$100)/$100 = 200% (æ¨èè´­ä¹°)
```

### â›“ï¸ å¤šé“¾æ”¯æŒ

```
æ´¾ç”Ÿè·¯å¾„æ ‡å‡†:
â”œâ”€â”€ Bitcoin (Legacy):     m/44'/0'/0'/0/x   (P2PKH)
â”œâ”€â”€ Bitcoin (SegWit):     m/49'/0'/0'/0/x   (P2SH-P2WPKH)
â”œâ”€â”€ Bitcoin (Native):     m/84'/0'/0'/0/x   (P2WPKH)
â”œâ”€â”€ Ethereum:             m/44'/60'/0'/0/x  (BIP-44)
â”œâ”€â”€ Solana:               m/44'/501'/0'/0'  (BIP-44)
â””â”€â”€ Base/EVM:             m/44'/60'/0'/0/x  (å…±äº«Ethereumè·¯å¾„)
```

---

## ç”¨æˆ·åˆ†å±‚å®‰å…¨ç­–ç•¥

åŸºäºå‰æ™¯ç†è®ºå’Œé£é™©åŒæ¶ç¨‹åº¦çš„åˆ†å±‚å»ºè®®ï¼š

### ğŸ›¡ï¸ é£é™©åŒæ¶å‹ (èµ„äº§ > $50,000)

**ç‰¹å¾**: Î» > 3.0 (é«˜æŸå¤±åŒæ¶ç³»æ•°)

```
æ¨èé…ç½®:
â”œâ”€ åŠ©è®°è¯: 24è¯ (256bitç†µå€¼)
â”œâ”€ Passphrase: å¯ç”¨ (é¢å¤–å®‰å…¨å±‚)
â”œâ”€ ç¡¬ä»¶é’±åŒ…: å¿…éœ€ (Ledger Stax / Trezor Safe 5)
â”œâ”€ å¤šç­¾: 2-of-3è®¾ç½®
â”œâ”€ å¤‡ä»½: åœ°ç†åˆ†æ•£ (3ä¸ªåœ°ç‚¹)
â””â”€ éªŒè¯: å­£åº¦æ¢å¤æµ‹è¯•

æœŸæœ›æ•ˆç”¨åˆ†æ:
â”œâ”€ å®‰å…¨æ”¶ç›Š: æŸå¤±æ¦‚ç‡ä»2%é™è‡³0.1%
â”œâ”€ æˆæœ¬: $200-400 (ç¡¬ä»¶+æ—¶é—´)
â”œâ”€ å¯¹$50kèµ„äº§: å¹´æœŸæœ›æŸå¤±å‡å°‘$950
â””â”€ å‡€æ•ˆç”¨: æé«˜ (å¼ºçƒˆæ¨è)
```

### âš–ï¸ é£é™©ä¸­æ€§å‹ (èµ„äº§ $5,000 - $50,000)

**ç‰¹å¾**: Î» â‰ˆ 2.25 (æ ‡å‡†æŸå¤±åŒæ¶)

```
æ¨èé…ç½®:
â”œâ”€ åŠ©è®°è¯: 24è¯
â”œâ”€ Passphrase: å¯é€‰
â”œâ”€ ç¡¬ä»¶é’±åŒ…: æ¨è
â”œâ”€ è½¯ä»¶é’±åŒ…: å¼ºå¯†ç  + 2FA
â”œâ”€ å¤‡ä»½: 2ä»½ç‰©ç†å¤‡ä»½
â””â”€ éªŒè¯: åŠå¹´æ¢å¤æµ‹è¯•

æœŸæœ›æ•ˆç”¨åˆ†æ:
â”œâ”€ å®‰å…¨æ”¶ç›Š: æŸå¤±æ¦‚ç‡ä»2%é™è‡³0.5%
â”œâ”€ æˆæœ¬: $100-150
â”œâ”€ å¯¹$20kèµ„äº§: å¹´æœŸæœ›æŸå¤±å‡å°‘$300
â””â”€ å‡€æ•ˆç”¨: é«˜ (æ¨èè´­ä¹°ç¡¬ä»¶é’±åŒ…)
```

### âš¡ ä¾¿åˆ©ä¼˜å…ˆå‹ (èµ„äº§ < $5,000)

**ç‰¹å¾**: Î» < 2.0 (è¾ƒä½æŸå¤±åŒæ¶)

```
æ¨èé…ç½®:
â”œâ”€ åŠ©è®°è¯: 12è¯ (è¶³å¤Ÿå®‰å…¨)
â”œâ”€ è½¯ä»¶é’±åŒ…: å¯ä¿¡åº”ç”¨
â”œâ”€ å¤‡ä»½: åŠ å¯†äº‘å¤‡ä»½ + ç‰©ç†å¤‡ä»½
â”œâ”€ é™é¢: è®¾ç½®äº¤æ˜“é™é¢
â””â”€ éªŒè¯: å¹´åº¦æ¢å¤æµ‹è¯•

æœŸæœ›æ•ˆç”¨åˆ†æ:
â”œâ”€ å®‰å…¨æ”¶ç›Š: æŸå¤±æ¦‚ç‡2% â†’ 1.5%
â”œâ”€ æˆæœ¬: æ¥è¿‘0
â”œâ”€ å¯¹$2kèµ„äº§: å¹´æœŸæœ›æŸå¤±å‡å°‘$10
â””â”€ ç¡¬ä»¶é’±åŒ…ROI: è´Ÿå€¼ (ä¸æ¨è)
```

---

## ä½¿ç”¨æ–¹æ³•

### åˆ›å»ºæ–°é’±åŒ… (HD Wallet)

```bash
# ç”Ÿæˆ24è¯åŠ©è®°è¯ + åŠ å¯†å­˜å‚¨ (æ¨è)
python ~/.kimi/skills/crypto-wallet/scripts/wallet.py create --name main --strength 256

# å¸¦é¢å¤–Passphraseåˆ›å»º (èµ„äº§>$10kæ¨è)
python ~/.kimi/skills/crypto-wallet/scripts/wallet.py create --name vault --passphrase

# ä¾¿åˆ©å‹é…ç½® (èµ„äº§<$5k)
python ~/.kimi/skills/crypto-wallet/scripts/wallet.py create --name daily --strength 128
```

### æ´¾ç”Ÿå¤šé“¾åœ°å€

```bash
# æ´¾ç”ŸBitcoinåœ°å€ (SegWit)
python ~/.kimi/skills/crypto-wallet/scripts/wallet.py derive --wallet main --chain bitcoin --type segwit

# æ´¾ç”ŸEthereumåœ°å€
python ~/.kimi/skills/crypto-wallet/scripts/wallet.py derive --wallet main --chain ethereum --index 0

# æ´¾ç”ŸSolanaåœ°å€
python ~/.kimi/skills/crypto-wallet/scripts/wallet.py derive --wallet main --chain solana
```

### å¯¼å…¥ç°æœ‰é’±åŒ…

```bash
# ä»åŠ©è®°è¯å¯¼å…¥ (24è¯)
python ~/.kimi/skills/crypto-wallet/scripts/wallet.py import --mnemonic "word1 word2 ... word24"

# ä»ç§é’¥å¯¼å…¥ (å•ä¸ªåœ°å€)
python ~/.kimi/skills/crypto-wallet/scripts/wallet.py import-key --key 0x... --chain ethereum
```

### æŸ¥è¯¢ä½™é¢

```bash
# æŸ¥è¯¢Solanaä½™é¢
python ~/.kimi/skills/crypto-wallet/scripts/balance.py --wallet main --chain solana

# æŸ¥è¯¢Baseä½™é¢ (ä½¿ç”¨ç›¸åŒEthereumåœ°å€)
python ~/.kimi/skills/crypto-wallet/scripts/balance.py --wallet main --chain base

# æŸ¥è¯¢æ‰€æœ‰é“¾ä½™é¢
python ~/.kimi/skills/crypto-wallet/scripts/balance.py --wallet main --all
```

---

## å› æœæ¨æ–­å®‰å…¨åˆ†æ

### å®‰å…¨æªæ–½çš„å› æœæ•ˆåº”

**çœŸå®å› æœå›¾:**

```
                      ç”¨æˆ·å®‰å…¨æ„è¯† (æ··æ·†å˜é‡)
                             â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                    â†“                    â†“
åŠ©è®°è¯å¼ºåº¦ â†â”€â”€â”€â”€ å®‰å…¨å®è·µ â”€â”€â”€â”€â†’ é’“é±¼è¯†åˆ«èƒ½åŠ›
        â†“                    â†“                    â†“
        â””â”€â”€â”€â”€â”€â”€â”€â”€â†’ å®é™…å®‰å…¨æ°´å¹³ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
              èµ„äº§æŸå¤±äº‹ä»¶
                      â†‘
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                 â†“                 â†“
ç½‘ç»œæ”»å‡»è€…      æ¶æ„è½¯ä»¶/æœ¨é©¬      ç‰©ç†ç›—çªƒ
```

**å…³é”®æ´å¯Ÿ:** å®‰å…¨æ„è¯†æ˜¯ä¸»è¦æ··æ·†å˜é‡ï¼Œé«˜å®‰å…¨æ„è¯†ç”¨æˆ·æ—¢ä½¿ç”¨æ›´å¼ºåŠ©è®°è¯ï¼Œä¹Ÿæ›´å°å¿ƒé˜²èŒƒé’“é±¼ã€‚

**å¹²é¢„åˆ†æ:**

```
è§‚å¯Ÿåˆ°çš„: P(æŸå¤±|ä½¿ç”¨ç¡¬ä»¶é’±åŒ…) = 0.5%
å®é™…å› æœ: P(æŸå¤±|do(ä½¿ç”¨ç¡¬ä»¶é’±åŒ…)) â‰ˆ 1.0%

å·®å¼‚è§£é‡Š:
â”œâ”€ è§‚å¯Ÿå€¼åä½ï¼šå› ä¸ºé€‰æ‹©ç¡¬ä»¶é’±åŒ…çš„ç”¨æˆ·æœ¬èº«æ›´è°¨æ…
â”œâ”€ çœŸå®æ•ˆåº”çº¦ä¸ºè§‚å¯Ÿå€¼çš„2å€
â””â”€ å¯¹æ™®é€šç”¨æˆ·çš„å®é™…ä¿æŠ¤æ•ˆæœçº¦ä¸º1%
```

### åé—¨å‡†åˆ™åº”ç”¨

ä¼°è®¡å®‰å…¨æªæ–½æ•ˆæœéœ€è¦æ§åˆ¶ï¼š
1. **ç”¨æˆ·å®‰å…¨æ„è¯†** (é€šè¿‡é—®å·è¯„ä¼°)
2. **èµ„äº§è§„æ¨¡** (é«˜ä»·å€¼ç”¨æˆ·æ›´è°¨æ…)
3. **ä½¿ç”¨é¢‘ç‡** (é¢‘ç¹ä½¿ç”¨å¢åŠ æš´éœ²)
4. **æŠ€æœ¯èƒŒæ™¯** (æŠ€æœ¯äººå‘˜æ›´æ‡‚å®‰å…¨)

**åˆ†å±‚å»ºè®®:**
- æŠ€æœ¯æ–°æ‰‹ï¼šä¼˜å…ˆç¡¬ä»¶é’±åŒ…ï¼ˆå‡å°‘äººä¸ºé”™è¯¯ï¼‰
- æŠ€æœ¯ä¸“å®¶ï¼šè½¯ä»¶é’±åŒ…+ä¸¥æ ¼æµç¨‹è¶³å¤Ÿ
- é«˜é¢‘äº¤æ˜“è€…ï¼šçƒ­é’±åŒ…+é™é¢ï¼Œå¤§é¢ä½¿ç”¨å†·å­˜å‚¨

---

## å‰æ™¯ç†è®ºåå·®é˜²æŠ¤

### å¸¸è§å¿ƒç†é™·é˜±

| åå·® | è¡¨ç° | é˜²æŠ¤æœºåˆ¶ |
|------|------|----------|
| **æŸå¤±åŒæ¶** | å¯¹Gasè´¹è¿‡åº¦æ•æ„Ÿï¼Œå»¶è¿Ÿå®‰å…¨å‡çº§ | ROIè®¡ç®—å™¨å±•ç¤ºé•¿æœŸæ”¶ç›Š |
| **ç¡®å®šæ€§æ•ˆåº”** | ä¸æ„¿ä¸ºä¸ç¡®å®šé£é™©æ”¯ä»˜ç¡®å®šæˆæœ¬ | æ¦‚ç‡å¯è§†åŒ–ï¼šå±•ç¤ºå¹´æŸå¤±æœŸæœ› |
| **åå°„æ•ˆåº”** | å¬è¯´è¢«ç›—åè¿‡åº¦ååº”æˆ–æ”¾å¼ƒ | ç†æ€§å®‰å…¨è¯„ä¼°å·¥å…· |
| **æ²‰æ²¡æˆæœ¬** | åšæŒä½¿ç”¨å·²æŠ•å…¥æ—¶é—´çš„ä¸å®‰å…¨æ–¹æ¡ˆ | å®‰å…¨è¿ç§»å‘å¯¼ |
| **å¯å¾—æ€§åè¯¯** | å› æœ€è¿‘æ–°é—»é«˜ä¼°æŸäº›é£é™© | åŸºç¡€ç‡æ•°æ®å±•ç¤º |

### å®‰å…¨å¥åº·æ£€æŸ¥

```bash
# è¿è¡Œå®‰å…¨è¯„ä¼°
python scripts/security-check.py --wallet main

è¾“å‡ºç¤ºä¾‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®‰å…¨å¥åº·è¯„åˆ†: 75/100                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸  å»ºè®®æ”¹è¿›:                           â”‚
â”‚   â€¢ å¯ç”¨Passphrase (+10åˆ†)              â”‚
â”‚   â€¢ è¿›è¡Œå¤‡ä»½æ¢å¤æµ‹è¯• (+5åˆ†)             â”‚
â”‚   â€¢ åˆ†æ•£å¤‡ä»½å­˜æ”¾åœ°ç‚¹ (+10åˆ†)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åŸºäºæ‚¨çš„èµ„äº§è§„æ¨¡($15k)ï¼Œå»ºè®®å‡çº§ç¡¬ä»¶é’±åŒ…â”‚
â”‚ æœŸæœ›å¹´æŸå¤±å‡å°‘: $285                    â”‚
â”‚ ç¡¬ä»¶é’±åŒ…æŠ•èµ„: $120                      â”‚
â”‚ ROI: 137%                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¯è¯ä¼ªæ€§å®‰å…¨å£°æ˜

### å¯éªŒè¯çš„å®‰å…¨å‡è®¾

| åŸé™ˆè¿° | å¯è¯ä¼ªæ”¹è¿›ç‰ˆæœ¬ |
|--------|----------------|
| "24è¯è¶³å¤Ÿå®‰å…¨" | "åœ¨ç°æœ‰è®¡ç®—èƒ½åŠ›ä¸‹ï¼Œ24è¯åŠ©è®°è¯çš„æš´åŠ›ç ´è§£æ¦‚ç‡<10^-20" |
| "ç¡¬ä»¶é’±åŒ…æ›´å®‰å…¨" | "ç¡¬ä»¶é’±åŒ…ç”¨æˆ·çš„å¹´èµ„äº§æŸå¤±ç‡<è½¯ä»¶é’±åŒ…ç”¨æˆ·çš„50%" |
| "Passphraseå¢åŠ å®‰å…¨" | "ä½¿ç”¨Passphraseçš„åŠ©è®°è¯æ³„éœ²äº‹ä»¶å¯¼è‡´çš„æŸå¤±ç‡<5%" |

### è¯ä¼ªæ ‡å‡†

```
å®‰å…¨å‡è®¾è¢«è¯ä¼ªçš„æ¡ä»¶:
â”œâ”€ BIP-39å®ç°å‘ç°ç³»ç»Ÿæ€§æ¼æ´
â”œâ”€ é‡å­è®¡ç®—çªç ´ä½¿ç ´è§£æ—¶é—´ç¼©çŸ­è‡³<100å¹´
â”œâ”€ ç¡¬ä»¶é’±åŒ…å‚å•†å‘ç°ä¾›åº”é“¾æ”»å‡»
â””â”€ è§‚å¯Ÿæ•°æ®æ˜¾ç¤ºæŸæªæ–½æ— æ•ˆ

å½“å‰çŠ¶æ€: æ‰€æœ‰æ ¸å¿ƒå‡è®¾æš‚æœªè¢«è¯ä¼ªï¼ŒæŒç»­ç›‘æ§ä¸­
```

---

## è®¤è¯†è®ºæ ¡å‡†

### ç½®ä¿¡åº¦æ ‡æ³¨

æ‰€æœ‰å®‰å…¨å»ºè®®æ ‡æ³¨ç½®ä¿¡åº¦çº§åˆ«ï¼š

| å»ºè®® | ç½®ä¿¡åº¦ | è¯æ®æ¥æº |
|------|--------|----------|
| 24è¯åŠ©è®°è¯æŠ—æš´åŠ›ç ´è§£ | 99% | æ•°å­¦è¯æ˜ + å®è·µéªŒè¯ |
| AES-256-GCMå®‰å…¨æ€§ | 95% | å¯†ç å­¦å…±è¯† |
| ç¡¬ä»¶é’±åŒ…é™ä½æŸå¤±ç‡50% | 70% | è§‚å¯Ÿæ•°æ®ï¼ˆå—æ··æ·†å˜é‡å½±å“ï¼‰ |
| Passphraseæœ‰æ•ˆé˜²æ­¢æ³„éœ²æŸå¤± | 80% | é€»è¾‘æ¨å¯¼ + æ¡ˆä¾‹ |
| é’“é±¼æ˜¯ä¸»è¦å¨èƒ | 90% | æŸå¤±äº‹ä»¶ç»Ÿè®¡ |

### ä¿¡å¿µæ›´æ–°åè®®

```
åˆå§‹ä¿¡å¿µ: "å½“å‰é…ç½®è¶³å¤Ÿå®‰å…¨" P=80%

æ–°è¯æ®å¤„ç†:
â”œâ”€ å‘ç°æ–°æ¼æ´ â†’ ä¸‹è°ƒå®‰å…¨è¯„ä¼°
â”œâ”€ æˆåŠŸæ¢å¤æµ‹è¯• â†’ ä¸Šè°ƒå¤‡ä»½ä¿¡å¿ƒ
â”œâ”€ è¡Œä¸šå®‰å…¨äº‹ä»¶ â†’ é‡æ–°è¯„ä¼°å¨èƒæ¨¡å‹
â””â”€ å®šæœŸ(å­£åº¦)å…¨é¢é‡è¯„

è¡ŒåŠ¨é˜ˆå€¼:
â”œâ”€ P(å®‰å…¨) > 90%: ç»´æŒç°çŠ¶
â”œâ”€ 70% < P(å®‰å…¨) < 90%: å°å¹…åº¦æ”¹è¿›
â”œâ”€ 50% < P(å®‰å…¨) < 70%: é‡å¤§å®‰å…¨å‡çº§
â””â”€ P(å®‰å…¨) < 50%: ç«‹å³è¿ç§»èµ„äº§
```

---

## æŠ€æœ¯è§„æ ¼

### BIP-39 åŠ©è®°è¯å®ç°

```python
# ç†µ -> åŠ©è®°è¯ -> ç§å­
entropy = generate_entropy(strength=256)  # 256 bits (24è¯)
mnemonic = entropy_to_mnemonic(entropy)    # 24 words
seed = mnemonic_to_seed(mnemonic, passphrase="")
# PBKDF2-HMAC-SHA512, 2048 rounds
```

### BIP-32 HDæ´¾ç”Ÿ

```python
# ä¸»å¯†é’¥æ´¾ç”Ÿ
master_key = HMAC_SHA512(key=b"Bitcoin seed", data=seed)
# åˆ†ä¸ºä¸»ç§é’¥(å·¦256ä½) + é“¾ç (å³256ä½)

# å­å¯†é’¥æ´¾ç”Ÿ
child_key = CKDpriv(parent_key, index, hardened=True)
# hardened: index >= 2^31 (é¦–æ¯”ç‰¹ä¸º1)
```

### BIP-44 å¤šè´¦æˆ·å±‚æ¬¡

```
m / purpose' / coin_type' / account' / change / address_index

purpose:   44 (Legacy), 49 (SegWit), 84 (Native SegWit)
coin_type: 0 (BTC), 60 (ETH), 501 (SOL), 8453 (Base)
account:   0, 1, 2... (å¤šè´¦æˆ·)
change:    0 (æ”¶æ¬¾), 1 (æ‰¾é›¶ - BTC only)
index:     0, 1, 2... (åœ°å€ç´¢å¼•)
```

---

## å®‰å…¨æ¨¡å‹

### å¯†é’¥å­˜å‚¨ (é›¶çŸ¥è¯†æ¶æ„)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç”¨æˆ·ä¸»å¯†ç  (ä¸å­˜å‚¨)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“ PBKDF2 600K rounds
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ´¾ç”ŸåŠ å¯†å¯†é’¥ (KEK)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“ AES-256-GCM
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    åŠ å¯†åçš„åŠ©è®°è¯/ç§é’¥ (æŒä¹…åŒ–)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å†…å­˜å®‰å…¨

- ç§é’¥åœ¨å†…å­˜ä¸­ä½¿ç”¨ `ctypes` + `mlock` é”å®š
- ä½¿ç”¨åç«‹å³ `memset` æ¸…é›¶
- ç¦æ­¢swapåˆ†åŒºäº¤æ¢æ•æ„Ÿæ•°æ®

### å¨èƒæ¨¡å‹

| å¨èƒ | æ¦‚ç‡ | é˜²æŠ¤ |
|------|------|------|
| å†·å­˜å‚¨æ”»å‡» | ä¸­ | AES-256åŠ å¯† + å¼ºå¯†ç  |
| å†…å­˜è½¬å‚¨ | ä½ | mlocké”å®š + åŠæ—¶æ¸…é›¶ |
| ä¾§ä¿¡é“ | æä½ | æ’å®šæ—¶é—´ç®—æ³• |
| åŠ©è®°è¯æ³„éœ² | ä½ | å¯é€‰BIP-39 Passphrase |
| é’“é±¼æ”»å‡» | é«˜ | ç”¨æˆ·æ•™è‚² + äº¤æ˜“ç¡®è®¤ |

---

## é…ç½®æ–‡ä»¶

```json
{
  "wallets": {
    "main": {
      "type": "hd",
      "encrypted_mnemonic": "enc:...",
      "salt": "...",
      "kdf": "pbkdf2",
      "kdf_params": {"iterations": 600000},
      "created_at": "2026-02-19T10:00:00Z",
      "security_level": "high",
      "has_passphrase": true
    }
  },
  "chains": {
    "solana": {
      "rpc": "https://api.mainnet-beta.solana.com",
      "derivation_path": "m/44'/501'/0'/0'"
    },
    "ethereum": {
      "rpc": "https://eth.llamarpc.com",
      "derivation_path": "m/44'/60'/0'/0/0"
    },
    "base": {
      "rpc": "https://mainnet.base.org",
      "derivation_path": "m/44'/60'/0'/0/0"
    }
  },
  "security_preferences": {
    "risk_profile": "balanced",
    "min_confidence_for_action": 0.8,
    "backup_reminder_interval_days": 90
  }
}
```

---

## å‚è€ƒå®ç°

### æ ¸å¿ƒæ ‡å‡†

- **BIP-32**: [bitcoin/bips/bip-0032](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki)
- **BIP-39**: [bitcoin/bips/bip-0039](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki)
- **BIP-44**: [bitcoin/bips/bip-0044](https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki)
- **SLIP-44**: [satoshilabs/slips/slip-0044](https://github.com/satoshilabs/slips/blob/master/slip-0044.md)

### å¼€æºå‚è€ƒ

- **bitcoinlib**: Pythonæ¯”ç‰¹å¸åº“ - https://github.com/1200wd/bitcoinlib
- **pycoin**: å¤šå¸ç§åŠ å¯†åº“ - https://github.com/richardkiss/pycoin
- **bitwarden-sdk**: Bitwardenå¯†ç å­¦SDK - https://github.com/bitwarden/sdk
- **Trezor Firmware**: ç¡¬ä»¶é’±åŒ…å›ºä»¶ - https://github.com/trezor/trezor-firmware

---

## ç‰ˆæœ¬ä¿¡æ¯

- **Version**: 3.0.0 (å†³ç­–æ¡†æ¶å¢å¼ºç‰ˆ)
- **Author**: KbotGenesis
- **Standards**: BIP-32/39/44/49/84
- **Encryption**: AES-256-GCM + PBKDF2/Argon2id
- **Frameworks**: Expected Utility, Prospect Theory, Causal Inference, Falsifiability, Epistemic Reasoning
- **License**: MIT
- **Last Updated**: 2026-02-20
