# Causal Inference Skill 分析报告

## 概况表格

| 项目 | 内容 |
|------|------|
| **Skill名称** | Causal Inference (因果推断) |
| **文件路径** | `.kimi/skills/causal-inference/SKILL.md` |
| **页数/行数** | 223行 |
| **质量评分** | ⭐⭐⭐⭐⭐ (5/5) |
| **优先级** | P0 |
| **类型** | 系统与因果 |
| **理论基础** | Judea Pearl《The Book of Why》|

---

## 推理方法分析

### 因果推断三层次 (Pearl框架)

| 层次 | 问题 | 数学表达 | 应用场景 |
|------|------|----------|----------|
| **关联 (Association)** | 观察到X，Y如何？ | P(Y\|X) | 相关性分析 |
| **干预 (Intervention)** | 实施X，Y如何？ | P(Y\|do(X)) | 策略效果评估 |
| **反事实 (Counterfactual)** | 如果X没发生？ | P(Yₓ' \| X=x) | 事后归因分析 |

### 核心推理方法

```
┌─────────────────────────────────────────────┐
│ 因果图 (Causal DAG)                          │
├─────────────────────────────────────────────┤
│ 链式: X → Z → Y      (Z是中介变量)           │
│ 分叉: X ← Z → Y      (Z是混淆变量)           │
│ 对撞: X → Z ← Y      (Z是对撞点)             │
└─────────────────────────────────────────────┘
```

### 识别策略工具箱

| 方法 | 适用场景 | 关键假设 | 强度 |
|------|----------|----------|------|
| **RCT** | 可控实验环境 | 随机化 | ⭐⭐⭐⭐⭐ |
| **断点回归 (RDD)** | 政策阈值场景 | 局部随机 | ⭐⭐⭐⭐ |
| **双重差分 (DiD)** | 政策评估 | 平行趋势 | ⭐⭐⭐⭐ |
| **工具变量 (IV)** | 内生性问题 | 相关性+排他性 | ⭐⭐⭐ |
| **因果发现算法** | 探索性分析 | 因果充分性 | ⭐⭐ |

### 后门准则 (核心公式)

```
P(Y|do(X)) = Σz P(Y|X,Z)P(Z)

步骤:
1. 找到所有指向X的后门路径
2. 识别混淆变量集合Z
3. 控制Z后，关联即因果
```

---

## 决策流程中的角色

### 在决策流程中的位置

```
问题定义 → 数据收集 → 【因果推断】 → 策略制定 → 执行评估
                     ↑
              Causal Inference 介入点
```

### 核心决策场景

| 场景 | 典型问题 | 推断方法 | 输出 |
|------|----------|----------|------|
| **增长归因** | 增长来自产品改进还是营销？ | 因果图+效应分解 | 各因素贡献度 |
| **策略评估** | 新定价策略真提升收入了吗？ | RCT/DiD | 因果效应量 |
| **反事实分析** | 如果没做这个决定会怎样？ | 反事实推理 | 对照组估计 |
| **混淆控制** | 能力强的员工本来就爱学习 | 后门准则 | 净效应 |

### 决策流程中的具体作用

```
┌─────────────────────────────────────────────┐
│ 决策前                                       │
│ ├─ 构建因果图，明确变量关系                  │
│ ├─ 识别混淆变量和中介变量                    │
│ └─ 设计数据收集策略                          │
├─────────────────────────────────────────────┤
│ 决策中                                       │
│ ├─ 估计干预效应 P(Y|do(X))                   │
│ ├─ 分解直接效应和间接效应                    │
│ └─ 计算置信区间                              │
├─────────────────────────────────────────────┤
│ 决策后                                       │
│ ├─ 反事实评估：如果未干预会怎样              │
│ ├─ 学习真实因果效应                          │
│ └─ 更新因果模型                              │
└─────────────────────────────────────────────┘
```

---

## 与其他决策Skills的关系

### 关系矩阵

| Skill | 关系类型 | 协作方式 |
|-------|----------|----------|
| **First-Order Logic** | 基础支撑 | 用逻辑验证因果推断的前提有效性 |
| **Bad Arguments** | 纠错 | 识别"相关≠因果"等常见谬误 |
| **Bayesian Decision** | 互补 | 因果提供结构，贝叶斯更新概率 |
| **System Dynamics** | 协同 | 因果图是系统动力学模型的基础 |
| **MCTS** | 输入 | 为决策树提供因果约束和转移概率 |

### 集成工作流

```
复杂业务决策分析流程:

Step 1: 问题定义
  └─ 明确干预变量X和结果Y

Step 2: 因果建模 (Causal Inference)
  └─ 绘制因果图
  └─ 识别混淆变量
  └─ 确定识别策略

Step 3: 逻辑验证 (First-Order Logic)
  └─ 验证因果假设的逻辑一致性
  └─ 检查隐含假设

Step 4: 谬误检测 (Bad Arguments)
  └─ 排除"后此谬误"等因果谬误
  └─ 避免混淆相关与因果

Step 5: 决策优化 (Bayesian/MCTS)
  └─ 基于因果效应进行决策
  └─ 计算最优干预策略

Step 6: 反事实学习
  └─ 比较实际结果与反事实
  └─ 更新因果模型
```

---

## 改进建议

### 优点
1. ✅ 理论基础扎实(Judea Pearl)
2. ✅ 三层次框架(关联/干预/反事实)清晰
3. ✅ 涵盖多种识别策略(RCT/DiD/IV等)
4. ✅ 提供检查清单和常见陷阱表
5. ✅ 业务增长归因场景贴近实际

### 改进建议

| 优先级 | 建议 | 预期效果 |
|--------|------|----------|
| **高** | 添加doWhy/PyCausal等工具集成示例 | 提升工程可用性 |
| **高** | 补充倾向得分匹配(PSM)方法 | 丰富观察研究方法 |
| **中** | 增加非线性因果效应估计内容 | 处理复杂业务场景 |
| **中** | 添加敏感性分析框架 | 增强结论稳健性 |
| **中** | 补充时间序列因果推断(如VAR/Granger) | 扩展应用场景 |
| **低** | 添加更多Python/R代码示例 | 降低实施门槛 |

### 与其他Skills的深度集成建议

1. **与System Dynamics结合**: 
   - 将因果图扩展为系统动力学模型
   - 进行动态因果效应模拟

2. **与First Principles结合**:
   - 用第一性原理构建因果图的先验结构
   - 用数据验证/修正理论因果模型

3. **与Lean Thinking结合**:
   - 识别价值流中的因果瓶颈
   - 验证改进措施的因果效应

---

## 总结

**Causal Inference** Skill是决策系统中的**因果验证层**，负责：
- 区分相关性与因果性
- 估计干预的真实效果
- 构建可解释的决策模型

**核心价值**: 在AI决策系统中，它是防止"虚假相关导致错误决策"的关键防线。

**推荐集成深度**: 极高 - 所有涉及"为什么"和"如果...会怎样"的决策都需要因果推断

**关键洞察**: 
> "相关告诉你'是什么'，因果告诉你'为什么'。"

在复杂的业务环境中，没有因果推断的决策就像在迷雾中航行——First-Order Logic确保船不漏水，Causal Inference确保航向正确。
