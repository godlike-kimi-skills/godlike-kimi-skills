# AHP (Analytic Hierarchy Process) Skill 分析报告

## 📋 概况表格

| 维度 | 评分/描述 |
|------|-----------|
| **质量评级** | ⭐⭐⭐☆☆ (3/5) |
| **理论深度** | 中等（基于Saaty经典理论） |
| **实用性** | 中等（流程清晰但细节不足） |
| **完整性** | 不够完整（缺少详细计算步骤） |
| **易用性** | 高（概念简单，1-9标度直观） |
| **适用场景** | 权重确定、优先级排序、方案选择 |

---

## 🎯 规划框架分析

### 1. 核心框架：层次分析法三层次

```
目标层 (Goal)
    │
    ├── 准则层 1 (Criterion) ──┐
    ├── 准则层 2 (Criterion) ──┼── 方案层 (Alternatives)
    ├── 准则层 3 (Criterion) ──┤
    └── 准则层 n (Criterion) ──┘
```

### 2. AHP五步骤

```
┌─────────────────────────────────────────────────────────────┐
│ 步骤1: 构建层次结构                                          │
│        目标 → 准则 → 子准则 → 方案                          │
├─────────────────────────────────────────────────────────────┤
│ 步骤2: Pairwise 比较                                         │
│        使用 1-9 标度构建判断矩阵                            │
├─────────────────────────────────────────────────────────────┤
│ 步骤3: 权重计算                                              │
│        特征向量法求各要素权重                               │
├─────────────────────────────────────────────────────────────┤
│ 步骤4: 一致性检验                                            │
│        CR < 0.1 方可接受                                     │
├─────────────────────────────────────────────────────────────┤
│ 步骤5: 层次总排序                                            │
│        综合各层权重得到最终排序                             │
└─────────────────────────────────────────────────────────────┘
```

### 3. 1-9标度定义

| 标度 | 含义 | 说明 |
|------|------|------|
| 1 | 同等重要 | 两因素贡献相同 |
| 3 | 稍微重要 | 经验/偏好略倾向一方 |
| 5 | 明显重要 | 经验/偏好强倾向一方 |
| 7 | 强烈重要 | 实践显示强烈倾向 |
| 9 | 极端重要 | 证据表明最高程度倾向 |
| 2,4,6,8 | 中间值 | 需要折中时使用 |

### 4. 一致性检验公式

```
CI = (λmax - n) / (n - 1)
CR = CI / RI

其中：
- λmax: 判断矩阵最大特征值
- n: 矩阵阶数
- RI: 随机一致性指标（查表）
- CR < 0.1: 通过一致性检验

RI参考值:
| n | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
|---|---|---|---|---|---|---|---|---|---|
| RI | 0 | 0 | 0.58 | 0.90 | 1.12 | 1.24 | 1.32 | 1.41 | 1.45 |
```

### 5. 框架优势

- ✅ **直观易用**：1-9标度易于理解和操作
- ✅ **一致性检验**：提供数学检验机制
- ✅ **层次结构**：系统化分解复杂决策
- ✅ **理论经典**：Saaty方法被广泛认可

### 6. 框架局限

- ❌ **计算细节缺失**：缺少特征向量计算步骤
- ❌ **权重计算示例少**：没有完整的计算案例
- ❌ **应用场景单薄**：仅2个简单场景
- ❌ **常见陷阱缺失**：未提及AHP的局限性和误用情况
- ❌ **与其他方法对比**：缺少与MAUT等方法的关系说明
- ❌ **软件工具缺失**：没有计算工具推荐

---

## 🧠 决策方法

### 1. Pairwise比较矩阵构建

```
示例：3个准则的比较矩阵

        C1    C2    C3
C1      1     3     5
C2     1/3    1     2
C3     1/5   1/2    1

含义: C1比C2稍微重要(3)，C1比C3明显重要(5)
```

### 2. 权重计算方法（Skill未详述）

| 方法 | 描述 | 复杂度 |
|------|------|--------|
| **特征向量法** | 计算判断矩阵最大特征值对应的特征向量 | 高 |
| **几何平均法** | 每行元素几何平均后归一化 | 中 |
| **算术平均法** | 每行元素算术平均后归一化 | 低 |

**标准计算步骤（应补充到Skill）：**
```
1. 构建判断矩阵A (n×n)
2. 计算每行元素的几何平均: GMᵢ = (∏aᵢⱼ)^(1/n)
3. 归一化得到权重: wᵢ = GMᵢ / ΣGMᵢ
4. 计算最大特征值: λmax = Σ(Aw)ᵢ / (n×wᵢ)
5. 计算CI和CR，检验一致性
```

### 3. 层次总排序

```
总排序权重 = Σ(准则层权重 × 方案层在该准则下的权重)

示例:
准则C1权重0.5，方案A在C1下权重0.6
准则C2权重0.3，方案A在C2下权重0.4
准则C3权重0.2，方案A在C3下权重0.7

方案A总权重 = 0.5×0.6 + 0.3×0.4 + 0.2×0.7 = 0.56
```

### 4. 决策流程

```
定义决策目标 → 构建层次结构 →  pairwise比较 → 计算权重 → 一致性检验 → 层次总排序 → 决策建议
      ↑                                                                            ↓
      └────────────────── (若不通过，重新比较) ← 检验CR < 0.1 ←────────────────────┘
```

---

## 🔗 与其他Planning Skills的关系

### 关系图谱

```
                    ┌──────────────────┐
                    │ strategic-planning│
                    │    (战略规划)     │
                    └────────┬─────────┘
                             │ 优先级排序
                             ↓
              ┌──────────────────────────────┐
              │     project-planning         │
              │       (项目规划)              │
              └────────────┬─────────────────┘
                           │ 技术选型
              ┌────────────┴────────────┐
              ↓                         ↓
    ┌─────────────────┐       ┌─────────────────┐
    │   maut-theory   │◄─────►│      ahp        │
    │  (多属性效用)    │ 权重  │   (层次分析)     │
    └─────────────────┘ 输入  └────────┬────────┘
                                       │ 权重输出
                                       ↓
                              ┌─────────────────┐
                              │  方案排序/选择   │
                              └─────────────────┘
```

### 协作模式

| 协作Skill | 协作方式 | 典型场景 |
|-----------|----------|----------|
| **maut-theory** | 权重输入 | MAUT使用AHP确定各维度权重 |
| **strategic-planning** | 优先级排序 | 确定战略举措执行顺序 |
| **project-planning** | 供应商选择 | 评估并选择最优供应商 |
| **bayesian-decision** | 概率更新 | 结合先验概率进行决策 |

### 与MAUT的关系

```
┌─────────────────────────────────────────────────────────────┐
│                     AHP vs MAUT 对比                         │
├─────────────────┬─────────────────┬─────────────────────────┤
│     维度        │       AHP       │          MAUT           │
├─────────────────┼─────────────────┼─────────────────────────┤
│ 主要用途        │ 权重确定+排序   │ 方案评估+效用计算       │
│ 理论基础        │ 线性代数/矩阵   │ 效用理论/决策理论       │
│ 风险处理        │ 不支持          │ 支持风险偏好建模        │
│ 计算复杂度      │ 低              │ 中等                    │
│ 一致性检验      │ CR检验          │ 多种检验方法            │
│ 最佳组合        │ AHP为MAUT定权重 │ MAUT使用AHP结果         │
└─────────────────┴─────────────────┴─────────────────────────┘
```

---

## 💡 实际项目应用方式

### 应用场景1：技术选型决策

```
目标：选择最优技术栈

准则层：
- 性能表现 (权重: 0.35)
- 开发效率 (权重: 0.25)
- 生态成熟度 (权重: 0.20)
- 团队熟悉度 (权重: 0.15)
- 长期维护成本 (权重: 0.05)

方案层：
- 方案 A: React + Node.js
- 方案 B: Vue + Go
- 方案 C: Angular + Java

输出：
- 各方案综合得分
- 排序结果
- 敏感性分析
```

### 应用场景2：供应商评估

```
评估维度：
- 价格竞争力 (25%)
- 交付能力 (25%)
- 质量标准 (20%)
- 服务水平 (15%)
- 战略匹配 (15%)

输出：
- 供应商综合排名
- 各维度得分明细
- 决策建议
```

### 应用场景3：项目优先级排序

```
流程：
1. 确定评估准则：战略价值、紧急程度、资源需求、风险
2. 使用AHP确定准则权重
3. 对各项目进行 pairwise 比较
4. 计算项目总排序权重
5. 确定项目执行优先级
```

---

## 📝 改进建议

### 高优先级改进（P1）

1. **补充详细计算步骤**
   - 特征向量法计算过程
   - 几何平均法简化计算
   - 完整的数值示例（从矩阵到最终结果）

2. **增加完整应用案例**
   - 从问题定义到最终排序的完整案例
   - 包含判断矩阵、权重计算、一致性检验全过程
   - 至少2个不同行业的案例

3. **增加计算工具推荐**
   - Excel实现模板
   - Python计算代码
   - 在线AHP工具推荐

4. **增加常见陷阱与局限**
   - 层次过多导致不一致
   - 判断矩阵填写的常见错误
   - 群体AHP的处理方法

### 中优先级改进（P2）

5. **增加与MAUT的整合说明**
   - 如何使用AHP为MAUT确定权重
   - 两者结合的最佳实践
   - 典型整合流程

6. **增加敏感性分析**
   - 权重变化对排序的影响
   - 判断矩阵微小变化的稳定性

7. **增加扩展方法**
   - 模糊AHP（处理不确定性）
   - ANP（网络层次分析法）简介

### 低优先级改进（P3）

8. **增加软件工具指南**
   - Expert Choice使用教程
   - Super Decisions简介
   - Python `ahpy`库使用

9. **增加更多应用场景**
   - 人才评估
   - 投资决策
   - 风险评估
   - 选址决策

---

## 📊 总结

| 维度 | 评价 |
|------|------|
| **核心价值** | 提供直观的权重确定和优先级排序方法 |
| **主要优势** | 1-9标度直观、一致性检验机制、层次结构清晰 |
| **关键不足** | 计算细节缺失、案例不足、陷阱说明缺失、工具推荐缺失 |
| **改进潜力** | 极高（当前仅为入门级别，补充后可提升至⭐⭐⭐⭐⭐） |
| **推荐指数** | ⭐⭐⭐☆☆（适合快速了解，但不适合深入应用） |

### 与同类Skill对比

| Skill | 质量评级 | 完整性 | 推荐指数 |
|-------|----------|--------|----------|
| **MAUT** | ⭐⭐⭐⭐⭐ | 非常完整 | 强烈推荐 |
| **Strategic Planning** | ⭐⭐⭐⭐☆ | 较完整 | 推荐 |
| **Project Planning** | ⭐⭐⭐⭐☆ | 较完整 | 推荐 |
| **AHP** | ⭐⭐⭐☆☆ | 不够完整 | 需要改进 |

---

*报告生成时间: 2026-02-19*  
*分析师: AI Agent*  
*版本: 1.0*
